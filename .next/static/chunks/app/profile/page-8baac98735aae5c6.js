(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[178],{93622:function(e,t,s){Promise.resolve().then(s.bind(s,1380))},1380:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return i}});var a=s(57437),r=s(71245),n=s(99376),c=s(2265);function i(){let{user:e,loading:t}=(0,r.a)(),s=(0,n.useRouter)();return((0,c.useEffect)(()=>{t||e||s.replace("/login")},[e,t,s]),t)?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:(0,a.jsx)("div",{className:"max-w-3xl mx-auto",children:(0,a.jsx)("div",{className:"bg-white shadow rounded-lg",children:(0,a.jsxs)("div",{className:"px-4 py-5 sm:p-6",children:[(0,a.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"User Profile"}),(0,a.jsx)("div",{className:"mt-6 border-t border-gray-200 pt-6",children:(0,a.jsxs)("dl",{className:"divide-y divide-gray-200",children:[(0,a.jsxs)("div",{className:"py-4 sm:py-5 sm:grid sm:grid-cols-3 sm:gap-4",children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"Full name"}),(0,a.jsxs)("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2",children:[e.firstName," ",e.lastName]})]}),(0,a.jsxs)("div",{className:"py-4 sm:py-5 sm:grid sm:grid-cols-3 sm:gap-4",children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"Email address"}),(0,a.jsx)("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2",children:e.email})]}),(0,a.jsxs)("div",{className:"py-4 sm:py-5 sm:grid sm:grid-cols-3 sm:gap-4",children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"Role"}),(0,a.jsx)("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2",children:e.role})]}),(0,a.jsxs)("div",{className:"py-4 sm:py-5 sm:grid sm:grid-cols-3 sm:gap-4",children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"Member since"}),(0,a.jsx)("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2",children:new Date(e.createdAt).toLocaleDateString()})]})]})}),(0,a.jsx)("div",{className:"mt-6",children:(0,a.jsx)("button",{onClick:()=>s.push("/dashboard"),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Back to Dashboard"})})]})})})}):null}},71245:function(e,t,s){"use strict";s.d(t,{AuthProvider:function(){return o},a:function(){return d}});var a=s(57437),r=s(2265),n=s(71837),c=s(69064),i=s(99376);let l=(0,r.createContext)(void 0),o=e=>{let{children:t}=e,[s,o]=(0,r.useState)(null),[d,u]=(0,r.useState)(!0),h=(0,i.useRouter)();(0,r.useEffect)(()=>{(async()=>{try{if(n.Z.isAuthenticated()){var e;let t=await n.Z.getProfile();o((null===(e=t.data)||void 0===e?void 0:e.user)||null)}}catch(e){console.error("Auth check failed:",e),await n.Z.logout()}finally{u(!1)}})()},[]);let m=async e=>{try{let t=await n.Z.login(e);o(t.data.user),c.Am.success("Welcome back!"),h.push("/dashboard")}catch(a){var t,s;let e=(null===(s=a.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.message)||"Login failed";throw c.Am.error(e),a}},p=async e=>{try{let t=await n.Z.register(e);o(t.data.user),c.Am.success("Account created successfully!"),h.push("/dashboard")}catch(a){var t,s;let e=(null===(s=a.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.message)||"Registration failed";throw c.Am.error(e),a}},g=async()=>{try{await n.Z.logout(),o(null),c.Am.success("Logged out successfully"),h.push("/login")}catch(e){console.error("Logout error:",e),o(null),h.push("/login")}},y=async e=>{var t,s,a;try{let s=await n.Z.updateProfile(e);o((null===(t=s.data)||void 0===t?void 0:t.user)||null),c.Am.success("Profile updated successfully")}catch(t){let e=(null===(a=t.response)||void 0===a?void 0:null===(s=a.data)||void 0===s?void 0:s.message)||"Profile update failed";throw c.Am.error(e),t}};return(0,a.jsx)(l.Provider,{value:{user:s,loading:d,login:m,register:p,logout:g,updateUser:y,isAuthenticated:!!s},children:t})},d=()=>{let e=(0,r.useContext)(l);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}},71837:function(e,t,s){"use strict";var a=s(83464),r=s(64131),n=s(69064);class c{async getUsers(){return(await this.client.get("/users")).data}setTokens(e,t){this.accessToken=e,r.Z.set("accessToken",e,{expires:7,secure:!0,sameSite:"strict"}),r.Z.set("refreshToken",t,{expires:30,secure:!0,sameSite:"strict"})}clearTokens(){this.accessToken=null,r.Z.remove("accessToken"),r.Z.remove("refreshToken")}async login(e){let t=await this.client.post("/auth/login",e),{accessToken:s,refreshToken:a}=t.data.data;return this.setTokens(s,a),t.data}async register(e){let t=await this.client.post("/auth/register",e),{accessToken:s,refreshToken:a}=t.data.data;return this.setTokens(s,a),t.data}async refreshToken(e){return(await this.client.post("/auth/refresh",{refreshToken:e})).data}async logout(){try{await this.client.post("/auth/logout")}catch(e){}finally{this.clearTokens()}}async getProfile(){return(await this.client.get("/auth/profile")).data}async updateProfile(e){return(await this.client.put("/auth/profile",e)).data}async changePassword(e){return(await this.client.put("/auth/change-password",e)).data}async getProjects(e){let t=new URLSearchParams;return e&&Object.entries(e).forEach(e=>{let[s,a]=e;null!=a&&t.append(s,String(a))}),(await this.client.get("/projects?".concat(t))).data}async getProject(e){return(await this.client.get("/projects/".concat(e))).data}async createProject(e){return(await this.client.post("/projects",e)).data}async updateProject(e,t){return(await this.client.put("/projects/".concat(e),t)).data}async deleteProject(e){return(await this.client.delete("/projects/".concat(e))).data}async getProjectStats(e){return(await this.client.get("/projects/".concat(e,"/stats"))).data}async getTasks(e){let t=new URLSearchParams;return e&&Object.entries(e).forEach(e=>{let[s,a]=e;null!=a&&t.append(s,String(a))}),(await this.client.get("/tasks?".concat(t))).data}async getTask(e){return(await this.client.get("/tasks/".concat(e))).data}async createTask(e){return(await this.client.post("/tasks",e)).data}async updateTask(e,t){return(await this.client.put("/tasks/".concat(e),t)).data}async deleteTask(e){return(await this.client.delete("/tasks/".concat(e))).data}async addTaskComment(e,t){return(await this.client.post("/tasks/".concat(e,"/comments"),{comment:t})).data}async getMyTasks(e){let t=new URLSearchParams;return e&&Object.entries(e).forEach(e=>{let[s,a]=e;null!=a&&t.append(s,String(a))}),(await this.client.get("/tasks/my-tasks?".concat(t))).data}async getDashboardAnalytics(){return(await this.client.get("/analytics/dashboard")).data}async getProjectAnalytics(e,t){let s=new URLSearchParams;return e&&s.append("startDate",e),t&&s.append("endDate",t),(await this.client.get("/analytics/projects?".concat(s))).data}async getTeamAnalytics(e,t){let s=new URLSearchParams;return e&&s.append("startDate",e),t&&s.append("endDate",t),(await this.client.get("/analytics/team?".concat(s))).data}isAuthenticated(){return!!this.accessToken}getAccessToken(){return this.accessToken}constructor(){this.accessToken=null;let e="http://localhost:5000/api".replace(/\/$/,"");console.log("\uD83D\uDD17 API Base URL:","".concat(e,"/api")),this.client=a.Z.create({baseURL:"".concat(e,"/api"),timeout:1e4,headers:{"Content-Type":"application/json"}}),this.accessToken=r.Z.get("accessToken")||null,this.client.interceptors.request.use(e=>(this.accessToken&&(e.headers.Authorization="Bearer ".concat(this.accessToken)),e),e=>Promise.reject(e)),this.client.interceptors.response.use(e=>e,async e=>{var t,s,a,c;let i=e.config;if((null===(t=e.response)||void 0===t?void 0:t.status)===401&&!i._retry){i._retry=!0;try{let e=r.Z.get("refreshToken");if(e){let t=await this.refreshToken(e);return this.setTokens(t.data.accessToken,t.data.refreshToken),this.client(i)}}catch(e){this.logout(),window.location.href="/login"}}if((null===(s=e.response)||void 0===s?void 0:s.status)!==401){let t=(null===(c=e.response)||void 0===c?void 0:null===(a=c.data)||void 0===a?void 0:a.message)||"An error occurred";n.Am.error(t)}return Promise.reject(e)})}}let i=new c;t.Z=i}},function(e){e.O(0,[610,971,117,744],function(){return e(e.s=93622)}),_N_E=e.O()}]);